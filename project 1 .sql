create table emp(emphno number(4)primary key,ename varchar2(100),job varchar2(50),mgr number(4),hiredate DATE,sal number(10,2),comm number(7,2),deptno number(2));

INSERT INTO emp VALUES (1001, 'CHINNI', 'CLERK', 7902, TO_DATE('17-DEC-2020','DD-MON-YYYY'), 1200, NULL, 20);
INSERT INTO emp VALUES (1002, 'SANTHU', 'SALESMAN', 7698, TO_DATE('20-FEB-2021','DD-MON-YYYY'), 1600, 300, 30);
INSERT INTO emp VALUES (1003, 'MAJA', 'SALESMAN', 7698, TO_DATE('22-FEB-2021','DD-MON-YYYY'), 1250, 500, 30);
INSERT INTO emp VALUES (1004, 'PALLAVI', 'MANAGER', 7839, TO_DATE('02-APR-2020','DD-MON-YYYY'), 2975, NULL, 20);
INSERT INTO emp VALUES (1005, 'NANDU', 'SALESMAN', 7698, TO_DATE('28-SEP-2020','DD-MON-YYYY'), 1250, 1400, 30);
INSERT INTO emp VALUES (1006, 'KEERTHI', 'MANAGER', 7839, TO_DATE('01-MAY-2020','DD-MON-YYYY'), 2850, NULL, 30);
INSERT INTO emp VALUES (1007, 'MADESH', 'MANAGER', 7839, TO_DATE('09-JUN-2020','DD-MON-YYYY'), 2450, NULL, 10);
INSERT INTO emp VALUES (1008, 'BABU', 'ANALYST', 7566, TO_DATE('13-JUL-2021','DD-MON-YYYY'), 3000, NULL, 20);
INSERT INTO emp VALUES (1009, 'SUMA', 'PRESIDENT', NULL, TO_DATE('17-NOV-2019','DD-MON-YYYY'), 5000, NULL, 10);
INSERT INTO emp VALUES (1010, 'LAXMI', 'SALESMAN', 7698, TO_DATE('08-SEP-2020','DD-MON-YYYY'), 1500, 0, 30);
INSERT INTO emp VALUES (1011, 'ADAMS', 'CLERK', 7788, TO_DATE('23-MAY-2021','DD-MON-YYYY'), 1100, NULL, 20);
INSERT INTO emp VALUES (1012, 'MANI', 'CLERK', 7698, TO_DATE('03-DEC-2020','DD-MON-YYYY'), 950, NULL, 30);
INSERT INTO emp VALUES (1013, 'VINOD', 'ANALYST', 7566, TO_DATE('03-DEC-2020','DD-MON-YYYY'), 3000, NULL, 20);
INSERT INTO emp VALUES (1014, 'BANU', 'CLERK', 7782, TO_DATE('23-JAN-2021','DD-MON-YYYY'), 1300, NULL, 10);
INSERT INTO emp VALUES (1015, 'REDDY', 'DEVELOPER', 7566, TO_DATE('14-MAR-2022','DD-MON-YYYY'), 2800, NULL, 40);
INSERT INTO emp VALUES (1016, 'RAO', 'TESTER', 7566, TO_DATE('22-MAR-2022','DD-MON-YYYY'), 2600, NULL, 40);
INSERT INTO emp VALUES (1017, 'SURESH', 'ANALYST', 7566, TO_DATE('30-MAR-2022','DD-MON-YYYY'), 3100, NULL, 40);
INSERT INTO emp VALUES (1018, 'RAHUL', 'ENGINEER', 7566, TO_DATE('05-MAY-2022','DD-MON-YYYY'), 3200, NULL, 40);
INSERT INTO emp VALUES (1019, 'PRIYA', 'HR', 7839, TO_DATE('10-MAY-2022','DD-MON-YYYY'), 2200, NULL, 10);
INSERT INTO emp VALUES (1020, 'KAVYA', 'ACCOUNTANT', 7782, TO_DATE('15-JUN-2022','DD-MON-YYYY'), 2100, NULL, 10);
INSERT INTO emp VALUES (1021, 'ARUN', 'SALESMAN', 7698, TO_DATE('21-JUN-2022','DD-MON-YYYY'), 1500, 200, 30);
INSERT INTO emp VALUES (1022, 'KIRAN', 'SALESMAN', 7698, TO_DATE('29-JUN-2022','DD-MON-YYYY'), 1400, 300, 30);
INSERT INTO emp VALUES (1023, 'SWATHI', 'CLERK', 7788, TO_DATE('03-JUL-2022','DD-MON-YYYY'), 1000, NULL, 20);
INSERT INTO emp VALUES (1024, 'ANITA', 'DEVELOPER', 7566, TO_DATE('07-JUL-2022','DD-MON-YYYY'), 2800, NULL, 40);
INSERT INTO emp VALUES (1025, 'MOHAN', 'ENGINEER', 7566, TO_DATE('10-JUL-2022','DD-MON-YYYY'), 2900, NULL, 40);
INSERT INTO emp VALUES (1026, 'VINAY', 'DEVELOPER', 7566, TO_DATE('13-JUL-2022','DD-MON-YYYY'), 2700, NULL, 40);
INSERT INTO emp VALUES (1027, 'NEHA', 'HR', 7839, TO_DATE('17-JUL-2022','DD-MON-YYYY'), 2300, NULL, 10);
INSERT INTO emp VALUES (1028, 'DEEPA', 'CLERK', 7782, TO_DATE('20-JUL-2022','DD-MON-YYYY'), 1150, NULL, 10);
INSERT INTO emp VALUES (1029, 'ARJUN', 'TESTER', 7566, TO_DATE('23-JUL-2022','DD-MON-YYYY'), 2500, NULL, 40);
INSERT INTO emp VALUES (1030, 'KARTHIK', 'DEVELOPER', 7566, TO_DATE('27-JUL-2022','DD-MON-YYYY'), 3000, NULL, 40);
INSERT INTO emp VALUES (1031, 'ROHIT', 'ENGINEER', 7566, TO_DATE('01-AUG-2022','DD-MON-YYYY'), 3100, NULL, 40);
INSERT INTO emp VALUES (1032, 'DIVYA', 'HR', 7839, TO_DATE('04-AUG-2022','DD-MON-YYYY'), 2400, NULL, 10);
INSERT INTO emp VALUES (1033, 'HARISH', 'MANAGER', 7839, TO_DATE('09-AUG-2022','DD-MON-YYYY'), 3500, NULL, 30);
INSERT INTO emp VALUES (1034, 'LAVANYA', 'CLERK', 7782, TO_DATE('12-AUG-2022','DD-MON-YYYY'), 1100, NULL, 10);
INSERT INTO emp VALUES (1035, 'SAI', 'DEVELOPER', 7566, TO_DATE('17-AUG-2022','DD-MON-YYYY'), 2750, NULL, 40);
INSERT INTO emp VALUES (1036, 'RAHUL K', 'ENGINEER', 7566, TO_DATE('20-AUG-2022','DD-MON-YYYY'), 2900, NULL, 40);
INSERT INTO emp VALUES (1037, 'SHREYA', 'TESTER', 7566, TO_DATE('25-AUG-2022','DD-MON-YYYY'), 2400, NULL, 40);
INSERT INTO emp VALUES (1038, 'ABHISHEK', 'DEVELOPER', 7566, TO_DATE('30-AUG-2022','DD-MON-YYYY'), 2950, NULL, 40);
INSERT INTO emp VALUES (1039, 'MEENA', 'CLERK', 7782, TO_DATE('04-SEP-2022','DD-MON-YYYY'), 1050, NULL, 10);
INSERT INTO emp VALUES (1040, 'SANDHYA', 'ACCOUNTANT', 7782, TO_DATE('10-SEP-2022','DD-MON-YYYY'), 2150, NULL, 10);
INSERT INTO emp VALUES (1041, 'VIJAY', 'SALESMAN', 7698, TO_DATE('15-SEP-2022','DD-MON-YYYY'), 1600, 400, 30);
INSERT INTO emp VALUES (1042, 'TEJA', 'CLERK', 7788, TO_DATE('20-SEP-2022','DD-MON-YYYY'), 950, NULL, 20);
INSERT INTO emp VALUES (1043, 'GOPI', 'DEVELOPER', 7566, TO_DATE('25-SEP-2022','DD-MON-YYYY'), 2850, NULL, 40);
INSERT INTO emp VALUES (1044, 'KRISHNA', 'ENGINEER', 7566, TO_DATE('30-SEP-2022','DD-MON-YYYY'), 3150, NULL, 40);
INSERT INTO emp VALUES (1045, 'NAVYA', 'HR', 7839, TO_DATE('05-OCT-2022','DD-MON-YYYY'), 2300, NULL, 10);
INSERT INTO emp VALUES (1046, 'SNEHA', 'ACCOUNTANT', 7782, TO_DATE('10-OCT-2022','DD-MON-YYYY'), 2100, NULL, 10);
INSERT INTO emp VALUES (1047, 'KUMAR', 'MANAGER', 7839, TO_DATE('15-OCT-2022','DD-MON-YYYY'), 3700, NULL, 30);
INSERT INTO emp VALUES (1048, 'RESHMA', 'DEVELOPER', 7566, TO_DATE('20-OCT-2022','DD-MON-YYYY'), 2900, NULL, 40);
INSERT INTO emp VALUES (1049, 'HEMANTH', 'TESTER', 7566, TO_DATE('25-OCT-2022','DD-MON-YYYY'), 2500, NULL, 40);
INSERT INTO emp VALUES (1050, 'NAVI', 'ENGINEER', 7566, TO_DATE('30-OCT-2022','DD-MON-YYYY'), 3050, NULL, 40);

select * from emp;
drop table emp;

--1.deptview-normal view
create view dept_view as
select emphno,ename,deptno
from emp
where deptno=40;

select * from dept_view;

---2.high salary view--normal view
CREATE VIEW high_salary_emp AS
SELECT emphno,ename,job,sal,hiredate,deptno
FROM emp
WHERE sal > 2500;

SELECT * FROM high_salary_emp;

--materialized view
CREATE MATERIALIZED VIEW emp_dept_avg_mv
BUILD IMMEDIATE
REFRESH COMPLETE ON DEMAND
AS
SELECT deptno, ROUND(AVG(sal), 2) AS avg_salary, COUNT(*) AS emp_count
FROM emp
GROUP BY deptno;

SELECT * FROM emp_dept_avg_mv;
commit;
